## 一. `DNS` 查询过程
`DNS`（`Domain Name System`）用于将域名解析为 `IP` 地址，其查询过程分为以下步骤：

### 1. 本地 `DNS` 缓存检查
- **操作系统缓存**：检查本地主机（如浏览器缓存、操作系统缓存）是否缓存过域名解析结果。
- **`Hosts` 文件**：若未命中缓存，检查本地 `hosts` 文件是否有手动配置的域名与 `IP` 映射。

### 2. 向本地 `DNS` 服务器发起查询
- **本地 `DNS` 服务器**（由 `ISP` 提供，如中国移动）接收请求：
  
  - 若本地 `DNS` 服务器缓存中有该域名的解析结果，直接返回 `IP`。
  - 若未缓存，则进入**递归查询**流程。

### 3. 递归查询流程（本地 `DNS` 服务器负责）
1. **根域名服务器查询**
   
   - 根 `DNS` 服务器返回顶级域（如 `.com`）的 `DNS` 服务器地址。
2. **顶级域 `DNS` 服务器查询**
    
   - 顶级域服务器返回负责该域名的权威 `DNS` 服务器地址（如 `example.com` 的权威 `DNS`）。
3. **权威 `DNS` 服务器查询**
   
   - 权威 `DNS` 服务器返回域名对应的 `IP` 地址（如 `93.184.216.34`）。

### 4. 结果返回与缓存
- 本地 `DNS` 服务器将 `IP` 返回给客户端，并缓存解析结果（根据 `TTL` 值）。
- 客户端浏览器缓存该 `IP`，后续访问直接使用。

### 补充说明
- **查询类型**：
   
  - **递归查询**：客户端要求 `DNS` 服务器必须返回最终结果（由本地 `DNS` 服务器完成迭代过程）。  
  - **迭代查询**：`DNS` 服务器仅返回下一级服务器地址，由请求者自行继续查询。
- **DNS 记录类型**：
  
  - `A` 记录：域名到 `IPv4` 的映射。  
  - `AAAA` 记录：域名到 `IPv6` 的映射。  
  - `CNAME` 记录：域名别名（常用于 `CDN`）。  
  - `MX` 记录：邮件服务器地址。

---

## 二. `CDN` 是什么，有什么作用
### 1. `CDN` 的定义
`CDN`（`Content Delivery Network`）是**内容分发网络**，通过全球分布的边缘节点缓存静态/动态内容，使用户就近访问资源，提升加载速度与可用性。

### 2. 核心工作原理
1. **`DNS` 重定向**
   
   - 用户请求域名时，`DNS` 通过 `CNAME` 记录解析到 `CDN` 的全局负载均衡器（`GSLB`）。
2. **节点选择**
   
   - `GSLB` 根据用户地理位置、网络状态、节点负载等，返回最优边缘节点 `IP`。
3. **内容分发**
   
   - 若边缘节点已缓存资源，直接返回给用户（**命中缓存**）。  
   - 若未缓存，边缘节点从源站拉取资源并缓存（**回源**），再返回给用户。

### 3. `CDN` 的核心作用
| 作用                | 说明                                                                 |
|---------------------|----------------------------------------------------------------------|
| **加速内容传输**     | 通过就近访问减少网络延迟，提升页面加载速度。                         |
| **降低源站负载**     | 缓存静态资源（如图片、`CSS`、`JS`），减少直接访问源站的请求量。           |
| **提升可用性**       | 自动故障转移：当某节点故障时，请求被路由到其他健康节点。              |
| **防御网络攻击**     | 缓解 `DDoS` 攻击（通过分布式节点分散流量）和 `CC` 攻击。                  |

### 4. 典型应用场景
- **静态资源加速**：图片、视频、文档等大文件分发。  
- **动态内容加速**：通过路由优化、`TCP` 协议优化加速 `API` 请求。  
- **直播与点播**：支持大规模视频流分发，降低卡顿率。  
- **安全防护**：集成 `WAF`（`Web` 应用防火墙）抵御恶意流量。

---
## 三. `Cookie` 和 `Session` 是什么，有什么区别
`Cookie` 和 `Session` 都用于管理用户的状态和身份，区别如下：

### Cookie
- **存储位置**：数据存储在**用户的浏览器**中。
- **工作机制**：服务器通过响应头（`Set-Cookie`）将一个或多个 `Cookie` 发送到浏览器，浏览器后续请求时会自动携带这些 `Cookie`（通过请求头的 `Cookie` 字段）。
- **用途**：用于客户端身份识别、保存用户偏好设置（如语言、主题）等。
- **生命周期**：可通过 `Expires` 或 `Max-Age` 属性设置过期时间。若未设置，则为会话 `Cookie`，浏览器关闭后失效。
- **安全性**：数据可能被用户读取或篡改，敏感信息需加密。可通过 `HttpOnly`（禁止 `JS` 访问）、`Secure`（仅 `HTTPS` 传输）等属性增强安全性。
- **容量限制**：单个域名下通常不超过 `4KB`，且浏览器对 `Cookie` 总数有限制。

### Session
- **存储位置**：数据存储在**服务器**上（如内存、数据库）。
- **工作机制**：服务器为每个会话生成唯一的 **`Session ID`**，通过 `Cookie` 或 `URL` 参数传递给浏览器。浏览器后续请求携带此 `ID`，服务器根据 `ID` 读取对应的 `Session` 数据。
- **用途**：维护用户登录状态、存储临时交互数据（如购物车内容）。
- **生命周期**：依赖会话持续时间，默认在用户关闭浏览器后失效。服务器也可设置超时时间强制过期。
- **安全性**：敏感数据存储在服务端，安全性更高。但需防范 `Session ID` 泄露（如劫持、预测）。
- **容量限制**：由服务器内存/存储配置决定，一般远大于 `Cookie`。

### 主要区别
| 特性                | `Cookie`                          | `Session`                      |
|---------------------|---------------------------------|------------------------------|
| **数据存储位置**     | 客户端                          | 服务端                       |
| **数据传输方式**     | 自动通过 `HTTP` 头                | 仅传递 `Session ID `           |
| **数据安全性**       | 较低（客户端可修改）            | 较高（服务端控制）           |
| **存储容量**         | 较小（约 `4KB`）                  | 较大（取决于服务器配置）     |
| **生命周期控制**     | 客户端或服务端均可设置过期时间  | 服务端控制过期时间           |
