### TCP连接如何确保可靠性

TCP通过差错控制(序列号，确认应答，数据校验)，超时重传，流量控制，拥塞控制等机制，确保了数据传输的可靠性和效率
1. 序列号：每个TCP段都有一个序列号，确保数据包的顺序正确
2. 数据校验：TCP使用校验和来检测数据在传输过程中是否出现错误，如果检测到错误，接收方会丢弃该数据包，并等待重传
3. 确认应答：接收方发送ACK确认收到的数据，如果发送方在一定时间内没有收到确认，会重新发送数据
4. 超时重传：发送方设置一个定时器，如果在定时器超时之前没有收到确认，发送方会重传数据
5. 流量控制：TCP通过滑动窗口机制进行流量控制，确保接收方能够处理发送方的数据量
6. 拥塞控制：TCP通过算法如慢启动，拥塞避免，快重传和快恢复，来控制数据的发送速率，防止网络拥塞


### 既然提到了拥塞控制，那你能说说拥塞控制是怎么实现的吗
TCP拥塞控制可以在网络出现拥塞时动态地调整数据传输的速率，以防止网络过载。TCP拥塞控制的主要机制包括以下几个方面：
1. 慢启动：初始阶段，TCP发送方会以较小的发送窗口开始传输数据。随着每次成功收到确认的数据，发送方逐渐增加发送窗口的大小，开始指数级的增长，这称为慢启动。这有助于在网络刚开始传输时谨慎地逐步增加速率，以避免引发拥塞
2. 拥塞避免：一旦达到一定的阈值(通常是慢启动阈值), TCP发送方就会进入拥塞避免阶段。在拥塞避免阶段，发送方以线性增加的方式增加发送窗口的大小，而不再是指数级的增长。这有助于控制发送速率，以避免引起网络拥塞
3. 快速重传：如果发送方连续收到相同的确认，它会认为发生了数据报的丢失，并会快速重传未确认的数据包，而不必等待超时。这有助于更快地恢复由于拥塞引起的数据包丢失
4. 快速恢复：在发生快速重传后，TCP进入快速恢复阶段。在这个阶段，发送方不会回到慢启动阶段，而是将慢启动阈值设置为当前窗口的一半，并将拥塞窗口大小设置为慢启动阈值加上已确认但未被快速重传的数据块的数量，这有助于更快地从拥塞中恢复


### TCP流量控制是怎么实现的
流量控制就是让发送方发送速率不要过快，让接收方来得及接收。利用滑动窗口机制就可以实施流量控制，主要方法就是动态调整发送方和接收方之间数据传输速率
1. 滑动窗口大小: 在TCP通信中，每个TCP报文段都包含一个窗口字段，该字段指示发送方可以发送多少字节的数据而不等待确认。这个窗口大小是动态调整的
2. 接收方窗口大小：接收方通过TCP报文中的窗口字段告诉发送方自己当前的可接收窗口大小。这是接收方缓冲区中还有多少可用空间。
3. 流量控制的目标：；流量控制的目标是确保发送方不要发送超过接收方缓冲区容量色的数据。如果接收方的缓冲区快满了，它会减小窗口大小，通知接收方暂停发送，以防止溢出
4. 动态调整：发送方会根据接收方的窗口大小动态调整发送数据的速率。如果接收方的窗口大小增加，发送方可以加速发送数据。如果窗口大小减小，发送方将减缓发送数据的速率
5. 确认机制：接收方会定期发送确认(ACK)报文，告知发送方已成功接收数据。这也与流量控制密切相关，因为接收方可以通过ACK报文段中的窗口字段来通知发送方它的当前窗口大小


### UDP怎么实现可靠传输
UDP它不属于连接型协议，因而具有资源消耗小，处理速度快的优点，所以通常音频，视频和普通数据在传送时使用UDP较多，因为它们即使偶尔丢失一两个数据包，也不会对接收结果产生太大影响。传输层无法保证数据的可靠传输，只能通过应用层来实现了。实现的方式可以参照TCP可靠性传输的方式，只是实现不在传输层，实现转移到了应用层。关键在于两点，从应用层角度考虑:
(1) 提供超时重传，能比米娜数据报丢失
(2) 提供确认序列号，可以对数据报进行确认和排序
本端: 首先在UDP数据报定义一个首部，首部包含确认序列号和时间戳，时间戳是用来计算RTT(数据报传输的往返时间)，计算出合适的RTO(重传的超时时间)。然后以等-停的方式发送数据报，即收到对端的确认之后才发送下一个的数据报。当时间超时，本端重传数据报，同时RTO扩大为原来的两倍，重新开始计时.
对端：接受到一个数据报之后取下该数据报首部的时间戳和确认序列号，并添加本端的确认数据报首部之后发送给本端。根据此序列号对已收到的数据报进行排序并丢失重复的数据报。
