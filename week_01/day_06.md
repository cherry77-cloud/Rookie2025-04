## 一、TCP 如何确保可靠性？

### 1. 核心机制
TCP 通过以下机制保障数据传输的可靠性：
- **序列号与确认应答**  
  - 每个 TCP 段携带唯一序列号，确保数据按序到达  
  - 接收方通过 ACK 确认已收到的数据段
- **数据校验和**  
  - 使用校验和检测数据错误，错误数据包会被丢弃并触发重传
- **超时重传**  
  - 发送方设置定时器，未收到 ACK 则重发数据
- **流量控制**  
  - 通过滑动窗口动态调整发送速率
- **拥塞控制**  
  - 自适应调节发送速率避免网络过载

---

### 2. 拥塞控制实现
```mermaid
graph TD
    A[拥塞控制] --> B[慢启动]
    A --> C[拥塞避免]
    A --> D[快速重传]
    A --> E[快速恢复]

    B --> |初始窗口指数增长| F[达到阈值]
    C --> |窗口线性增长| G[发现丢包]
    D --> |3次重复ACK触发| H[立即重传]
    E --> |调整阈值和窗口| I[恢复传输]
```


| 阶段         | 机制描述                                                                 |
|--------------|--------------------------------------------------------------------------|
| **慢启动**   | 初始窗口从 1 MSS 开始，每收到 ACK 窗口指数增长，直到达到慢启动阈值（ssthresh） |
| **拥塞避免** | 窗口线性增长（每 RTT 增加 1 MSS），避免快速增长引发拥塞                    |
| **快速重传** | 收到 3 次重复 ACK 立即重传，无需等待超时                                  |
| **快速恢复** | 将 ssthresh 设为当前窗口一半，窗口调整为 ssthresh + 3 MSS，继续拥塞避免    |

TCP 拥塞控制通过慢启动、拥塞避免、快速重传和快速恢复四个阶段，动态调整发送窗口大小，确保网络传输的可靠性和效率。

---
